!function(C){function q(e,t,s='info',a=!1,n=!1){var i=C('#uucss-wrapper'),l=C(C('.uucss-info-wrapper.safelist-settings')[0]).clone().css('max-width','100%');l.length&&(a?l.find('h4').html(e+'<span data-notice_id="'+n+'" class="dashicons dashicons-no-alt notice-close '+s+'"></span>'):l.find('h4').text(e),l.find('p').remove(),l.find('.info-details').append('<p class="divider"></p>').append('<p>'+t+'</p>'),i.prepend('<li class="uucss-notification uucss-notification-'+s+' uucss-info-wrapper"><div class="content">'+l.html()+'</div></li>').parent().show())}C(document).ready(function(){C.fn.dataTable.ext.errMode='none',window.uucss&&window.uucss.notifications.length&&window.uucss.notifications.forEach(function(e){q(e.title,e.message,e.type)}),
// options page
window.tagBox.init();var e=C('#uucss_api_key'),c=C('.uucss-history.uucss-job-history .spinner-history'),r=C('.uucss-history.uucss-rule-history .spinner-history');try{var t=new URL(window.location.href);t.search.includes('token')&&(t.searchParams.delete('token'),t.searchParams.delete('nonce'),history.pushState('',document.title,t)),t.search.includes('deactivated')&&(t.searchParams.delete('deactivated'),history.pushState('',document.title,t))}catch(e){}var a=C('#whitelist_packs'),o=(a.select2({ajax:{url:window.uucss.api+'/whitelist-packs',data:function(e){return{s:e.term,url:window.location.origin}},headers:{Authorization:"Bearer "+e.val(),"Content-Type":"application/json"},delay:150,cache:!0,processResults:function(e){return{results:e.data.map(function(e){return{id:e.id+":"+e.name,text:e.name}}),pagination:{more:!1}}}},maximumSelectionLength:5,width:'100%'}),C('#uucss-pack-suggest').click(function(){var t=C(this),s=t.val();t.val('loading..'),wp.ajax.post('suggest_whitelist_packs',{nonce:window.uucss.nonce}).done(function(e){t.val(s),e&&e.forEach(function(e){0===C("li[title='"+e.name+"']").length&&(e=new Option(e.name,e.id+':'+e.name,!0,!0),a.append(e).trigger('change'))})}).fail(function(){t.val('Load Recommended Packs'),C('#uucss-pack-suggest-error').text('error : something went wrong, please contact support')})}),(
/*$.each($('span.dashicons.has-tooltip'),function(index, value){
            tippy($(value)[0], {
                content: $($(value)[0]).data('message'),
                allowHTML: true,
                placement: 'auto',
                animation: null,
                theme: 'light',
                interactive: true,
                delay: 0,
                arrow: false,
                offset: [0, 7]
            });
        });*/
""===window.uucss.rules_enabled?C('#uucss-wrapper li:not(:nth-child(2)) h2'):C('#uucss-wrapper li:not(:nth-child(2),:nth-child(3)) h2')).click(function(){C(this).parent().find('.content').slideToggle('fast'),C(this).find('.uucss-toggle-section').toggleClass('rotate')}),C('#uucss-history')),d=C('#uucss-rule-history'),n=(o.on('init.dt',function(){setInterval(s,5e3)}),d.on('init.dt',function(){setInterval(b,5e3)}),o.on('error.dt',function(e,t,s,a){C.uucss_log({log:a})}),d.on('error.dt',function(e,t,s,a){C.uucss_log({log:a})}),o.on('draw.dt',function(e,t){C('#uucss-history_info').append("<div id=\"uucss-auto-refresh\" class=\"uucss-auto-refresh\"><input type=\"checkbox\" id=\"uucss_auto_refresh_frontend\" name=\"autoptimize_uucss_settings[uucss_auto_refresh_frontend]\" value=\"1\"><label for=\"uucss_auto_refresh_frontend\"> Auto Refresh</label><br><div>"),C('#uucss_auto_refresh_frontend').change(function(){C('#uucss_auto_refresh_frontend-hidden').val(C(this).is(':checked')?1:0),n=C(this).is(':checked')}),C('#uucss_auto_refresh_frontend').prop('checked',n);C("<div class=\"dataTables_length\" id=\"uucss-history_length\"><label>Show <select name=\"uucss-history_length\" aria-controls=\"uucss-history\" class=\"\"><option value=\"10\" selected>10</option><option value=\"25\">25</option><option value=\"50\">50</option><option value=\"100\">100</option></select></label></div>").prependTo(C('#uucss-history_info'));var s='',s=("1"===window.uucss.rules_enabled&&(s='<option value="rule-based" '+('rule-based'===l?'selected':'')+'>Rule Based</option>'),C("<select class=\"status\"><option value=\"\" "+(''===l?'selected':'')+">All</option><option value=\"queued\" "+('queued'===l?'selected':'')+">Queued</option><option value=\"waiting\" "+('waiting'===l?'selected':'')+">Waiting</option><option value=\"processing\" "+('processing'===l?'selected':'')+">Processing</option><option value=\"success\" "+('success'===l?'selected':'')+">Success</option><option value=\"warning\" "+('warning'===l?'selected':'')+">Warning</option><option value=\"failed\" "+('failed'===l?'selected':'')+'>Failed</option>'+s+'</select>')),s=(C('<div class="uucss-url-search-wrap"><input type="search" placeholder="Search" value="'+p+'"><input class="uucss_search_exact" type="checkbox" id="uucss_search_exact" value="1"></div>').prependTo(C('#uucss-history_info')),C(s).prependTo(C('#uucss-history_info')),C('#uucss-history_info select.status').on('change',function(){l=C(this).val(),o.column(4).search(l?'^'+l+'$':'',!0,!1).draw()}),tippy(C('.uucss_search_exact')[0],{content:'Exact Match',placement:'top',appendTo:'parent'}),C('#uucss-history_info input[type="search"]')),a=C('#uucss-history_info input.uucss_search_exact');s.on('input',function(){p=C(this).val();var e=g?'^'+p+'$':p;o.column(1).search(p?e:'',!0,!1).draw()}),a.on('change',function(){g=C(this).prop('checked')}),''!==p&&s.focus().val('').val(p),a.prop('checked',g),C('#uucss-history tbody tr').off(),C('#uucss-history tbody tr').click(function(){C(this).toggleClass('selected');var e=C('#uucss-history tbody tr.selected'),t=C('#uucss-wrapper li.uucss-history.uucss-job-history');C('#uucss-wrapper li.uucss-history.uucss-job-history .multiple-selected-text .multiple-selected-value').text('('+e.length+') URLs'),1<e.length?t.hasClass('multi-select')||t.addClass('multi-select'):t.hasClass('multi-select')&&t.removeClass('multi-select')}),C('#uucss-history_length select').change(function(){(f=C(this).val())&&(c.addClass('loading'),o.page.len(f),o.ajax.reload(null,!1))}),10!==Number(f)&&C('#uucss-history_length select').val(f)}),d.on('draw.dt',function(e,t){C('#uucss-rule-history_wrapper .dataTables_info').append("<div id=\"uucss-auto-refresh-rule\" class=\"uucss-auto-refresh\"><input type=\"checkbox\" id=\"uucss_auto_refresh_frontend_rule\" name=\"autoptimize_uucss_settings[uucss_auto_refresh_frontend_rule]\" value=\"1\"><label for=\"uucss_auto_refresh_frontend_rule\"> Auto Refresh</label><br><div>"),C('#uucss_auto_refresh_frontend_rule').change(function(){C('#uucss_auto_refresh_frontend-hidden_rule').val(C(this).is(':checked')?1:0),i=C(this).is(':checked')}),C('#uucss_auto_refresh_frontend_rule').prop('checked',i);C("<div class=\"dataTables_length\" id=\"uucss-rule-history_length\"><label>Show <select name=\"uucss-rule-history_length\" aria-controls=\"uucss-rule-history\" class=\"\"><option value=\"15\" selected>15</option><option value=\"25\">25</option><option value=\"50\">50</option><option value=\"100\">100</option></select></label></div>").prependTo(C('#uucss-rule-history_info'));var s=C("<select class=\"status\"><option value=\"\" "+(''===u?'selected':'')+">All</option><option value=\"queued\" "+('queued'===u?'selected':'')+">Queued</option><option value=\"waiting\" "+('waiting'===u?'selected':'')+">Waiting</option><option value=\"processing\" "+('processing'===u?'selected':'')+">Processing</option><option value=\"success\" "+('success'===u?'selected':'')+">Success</option><option value=\"warning\" "+('warning'===u?'selected':'')+">Warning</option><option value=\"failed\" "+('failed'===u?'selected':'')+">Failed</option></select>"),s=(C('<div class="uucss-url-search-wrap"><input type="search" placeholder="Search" value="'+p+'"><input class="uucss_search_exact" type="checkbox" id="uucss_search_exact_rule" value="1"></div>').prependTo(C('#uucss-rule-history_info')),C(s).prependTo(C('#uucss-rule-history_info')),C('#uucss-rule-history_info select.status').on('change',function(){u=C(this).val(),d.column(4).search(u?'^'+u+'$':'',!0,!1).draw()}),C('#uucss-rule-history_info input[type="search"]')),a=C('#uucss-rule-history_info input.uucss_search_exact');s.on('input',function(){h=C(this).val();var e=_?'^'+h+'$':h;d.column(1).search(h?e:'',!0,!1).draw()}),a.on('change',function(){_=C(this).prop('checked')}),''!==h&&s.focus().val('').val(h),a.prop('checked',_),C('#uucss-rule-history tbody tr').off(),C('#uucss-rule-history tbody tr').click(function(){C(this).toggleClass('selected');var e=C('#uucss-rule-history tbody tr.selected'),t=C('#uucss-wrapper li.uucss-history.uucss-rule-history');C('#uucss-wrapper li.uucss-history.uucss-rule-history .multiple-selected-text .multiple-selected-value').text('('+e.length+') Rules'),1<e.length?t.hasClass('multi-select')||t.addClass('multi-select'):t.hasClass('multi-select')&&t.removeClass('multi-select')}),C('#uucss-rule-history_length select').change(function(){(m=C(this).val())&&(r.addClass('loading'),d.page.len(m),d.ajax.reload(null,!1))}),10!==Number(m)&&C('#uucss-rule-history_length select').val(m),C('#uucss-rule-history thead tr th.applied-links').click(function(){d.columns([3]).visible(!0)}),C('#uucss-rule-history thead tr th.hits-count').click(function(){d.columns([3]).visible(!1)})}),'1'==C('#uucss_auto_refresh_frontend-hidden').val()),i='1'==C('#uucss_auto_refresh_frontend-hidden_rule').val(),l='',u='',p='',h='',f='10',m='10',g=!1,_=!1;function v(e,t={},s=[],a='requeue_all_url'){s={url_list:s,url:t.url,rule:t.rule,regex:t.regex,post_type:e,type:a,job_type:a,nonce:window.uucss.nonce}
/*wp.ajax.post('uucss_queue',data_).then(function (i) {
                if(table && type === 'path'){
                    table.ajax.reload(null, false);
                }else if(rule_table && type === 'rule'){
                    rule_table.ajax.reload(null, false);
                }
            }).done(function () {
                $('#uucss-wrapper li.uucss-history').hasClass('multi-select') && $('#uucss-wrapper li.uucss-history').removeClass('multi-select');
            });*/;wp.ajax.post('rapidload_purge_all',s).then(function(e){}).done(function(){C('#uucss-wrapper li.uucss-history').hasClass('multi-select')&&C('#uucss-wrapper li.uucss-history').removeClass('multi-select')})}function w(e,t,s,a,n,i={}){var l=(i.rule?d:o).row(a),u=C(s),a=(u.addClass('loading'),(i.rule?r:c).addClass('loading'),t||C(this).hide(),{url:n.url,clear:t,nonce:window.uucss.nonce});i.rule&&i.regex&&(a.rule=i.rule,a.regex=i.regex),i.immediate&&(a.immediate=!0),(a.clear||a.immediate)&&(a.rule&&a.regex?a.job_type='rule':a.url&&(a.job_type='url')),C.ajax({method:'POST',url:wp.ajax.settings.url+'?action=rapidload_purge_all',data:a,success:function(e){(i.rule?r:c).removeClass('loading'),e.success&&(t?0<l.length&&l.remove().draw():(n.status='queued',l.data(n).draw(!1)))},complete:function(){u.removeClass('loading')}})}function s(){!n||C('.tippy-content').length||C('#uucss-wrapper .uucss-job-history select:focus').length||C('html.with-featherlight').length||C('#uucss-wrapper li.uucss-job-history').hasClass('multi-select')||(c.addClass('loading'),o.ajax.reload(null,!1))}function b(){!i||C('.tippy-content').length||C('#uucss-wrapper .uucss-rule-history select:focus').length||C('html.with-featherlight').length||C('#uucss-wrapper li.uucss-rule-history').hasClass('multi-select')||(r.addClass('loading'),d.ajax.reload(null,!1))}function y(e,t){var s=C('#uucss_queue_interval option[value="'+e+'"]').data('max'),a=C('#uucss_jobs_per_queue option');C.each(a,function(e){C(a[e]).attr('disabled',C(a[e]).val()>s)}),t&&C('#uucss_jobs_per_queue').val(C(a[0]).val())}function x(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)}c.addClass('loading'),o=o.DataTable({serverSide:!0,processing:!1,language:{processing:'<span class="spinner loading"></span>'},ajax:{beforeSend(){c.hasClass('loading')||c.addClass('loading')},url:wp.ajax.settings.url+'?action=uucss_data',type:'POST',data:function(e){return""!==l&&void 0!==l&&e.columns[0]&&e.columns[0].search&&(e.columns[0].search.value=l),""!==p&&void 0!==p&&e.columns[1]&&e.columns[1].search&&(e.columns[1].search.value=p,e.columns[1].search.regex=g),e.nonce=uucss.nonce,e},dataSrc:function(e){return c.removeClass('loading'),e.success?e.data:(C.uucssAlert("Failed to fetch optimizations",'error'),[])}},searching:!0,pagingType:"simple",tfoot:!1,lengthChange:!1,bSort:!1,columns:[{data:"status",title:"Status",width:'50px',className:'dt-body-center dt-head-center',render:function(e,t,s,a){var n='status ';return'queued'!==e&&'processing'!==e||(n+='refresh '),'<span class="job-status '+(n+=e+' ')+'">'+e+'</span>'}},{data:"url",title:"URL",className:"url",render(e){return e?'<a href="'+decodeURI(e)+'" target="_blank">'+decodeURI(e)+'</a>':''}},{data:"rule",title:"Rule",width:'100px',visible:"1"===window.uucss.rules_enabled,className:'dt-body-center dt-head-center',render:function(e,t,s,a){return'<span class="">'+(e?e.replace('is_',''):'')+'</span>'}},{data:"url",className:'dt-body-center dt-head-center stats th-reduction',title:"File Size Reduction",width:'145px',render:function(e,t,s,a){return s.meta&&s.meta.stats&&('success'===s.status||'success'===s.rule_status)?s.meta.stats.reduction+'%':'queued'===s.status||'processing'===s.status||'waiting'===s.status||'rule-based'===s.status?'<span class="job-file-size">-</span>':'0 KB'},createdCell:function(e,t,s){var a,n,i,l,u,e=C(e).wrapInner(C('<span></span>')),c=C('<div class="uucss-warnings"></div>'),r=C('<div class="cpcss-status cpcss-status-'+(s.cpcss?s.cpcss.status:'')+'"></div>'),o=(s.meta&&s.meta.stats&&('success'===s.status||'success'===s.rule_status)&&s.cpcss&&'success'===s.cpcss.status&&(r.append('<span class="dashicons dashicons-yes-alt" style="color : #009688; width: 16px; height: 16px"></span>'),r.append('<span style="font-size: 12px; margin-left:2px">Critical css generated ('+s.cpcss.hits+'/'+s.cpcss.attempts+')</span>')),window.uucss&&window.uucss.uucss_enable_debug||s.meta?.warnings?.length&&(s.meta.warnings=s.meta.warnings.filter(function(e){return!e.message.toString().includes('optimized version for the file missing')})),[]),d=((o=s.meta&&s.meta.warnings&&s.meta.warnings.length?'rule-based'===s.status?s.meta.warnings.filter(e=>e.id==s.job_id):s.meta.warnings:o).length?(i=2<o.length?'scrollable':'',c.append('<h5 class="warnings-title ">Warnings ('+o.length+')</h5>'),c.append('<ul class="warning-list '+i+'"></ul>'),C.each(o,function(e,t){var s=C('<li class="warning"></li>');s.append('<div class="warning-info"></div>'),s.find('.warning-info').append('<p class="warning-header">'+t.message+'</p>'),t.file&&s.find('.warning-info').append('<p class="warning-content"><a href="'+t.file+'" target="_blank">'+t.file+'</a></p>'),c.find('.warning-list').append(s.wrap('<div></div>').parent().html())})):c.removeClass('uucss-warnings'),'');'success'===s.status&&0<s.success_count||'success'===s.rule_status&&0<s.success_count&&0<s.rule_hits?d='Hits : '+s.success_count+'/'+s.attempts:s.meta&&s.meta.stats&&0<s.meta.stats.success_count?d='Hits : '+s.meta.stats.success_count+'/'+s.attempts:0!==Number(s.attempts)&&(d='Attempts : '+s.attempts),i={theme:'light',triggerTarget:e.find('span')[0],content:function(){var e=C("<div class=\"stat-tooltip\">       <div class=\"progress-bar-wrapper\">           <div class=\"progress-bar w-100\">               <span style=\"width:"+(100-s.meta.stats.reduction)+'%">'+(100-s.meta.stats.reduction).toFixed()+"%               </span>           </div>       </div>"+r.wrap('<div class="cpcss-result"></div>').parent().html()+c.wrap('<div></div>').parent().html()+"<div class=\"time\">   <p class=\"val uucss-show-job-details\">Created at "+new Date(1e3*s.time).toLocaleDateString()+' '+new Date(1e3*s.time).toLocaleTimeString()+"   </p>   <p class=\"attempts\">"+d+"   </p></div></div>");return a=tippy(e.find('.progress-bar-wrapper')[0],{content:'Without RapidLoad <span class="perc">'+s.meta.stats.before+'</span>',allowHTML:!0,placement:'bottom-end',trigger:'manual',hideOnClick:!1,animation:null,theme:'tomato',interactive:!0,delay:0,offset:[0,7],inlinePositioning:!0}),n=tippy(e.find('.progress-bar')[0],{content:'RapidLoad <span class="perc"> '+s.meta.stats.after+'</span>',allowHTML:!0,placement:'top-start',trigger:'manual',hideOnClick:!1,animation:null,theme:'ketchup',interactive:!0,delay:0,inlinePositioning:!0}),e[0]},placement:'left',
//trigger: 'click',
interactive:!0,allowHTML:!0,animation:"shift-toward-extreme",appendTo:"parent",onShow:function(){a.show(),n.show()},onShown:function(e){C(e.popper).find('.progress-bar.w-100').removeClass('w-100'),C('.uucss-show-job-details').featherlight('<div><div class="code"><pre><code>'+JSON.stringify(s,void 0,2)+'</code></pre></div></div>',{variant:'uucss-job-details'})},onHide:function(e){a.hide(),n.hide(),C(e.popper).find('.progress-bar').addClass('w-100')}},'failed'===s.status?(e.find('span').append('<span class="dashicons dashicons-info error"></span>'),i.onShow=function(){},i.onHide=function(){},u=s.meta.error&&s.meta.error.code?s.meta.error.code:500,l=s.meta.error&&s.meta.error.message?s.meta.error.message:'Unknown Error Occurred',i.content='<div class="error-tooltip"><h5>Error</h5> <span><strong>CODE :</strong> '+u+'</span> <br><span>'+l+'</span></div>',
//tippyOptions.triggerTarget = $(td).closest('tr')[0]
tippy(e.find('span')[0],i)):!s.meta||!s.meta.stats||'success'!==s.status&&'success'!==s.rule_status||o&&o.length?'success'!==s.status&&'success'!==s.rule_status||!o.length||(e.find('span').append('<span class="dashicons dashicons-warning"></span>'),tippy(e.find('span')[0],i)):(u=s.meta&&s.meta.stats&&0<s.meta.stats.success_count||'success'===s.status&&0<s.success_count||'rule-based'===s.status&&0<s.success_count&&0<s.success_count?'hits-success':'',e.find('span').append('<span class="dashicons dashicons-yes-alt '+u+'"></span>'),tippy(e.find('span')[0],i))}},{data:"url",className:'dt-body-right dt-head-right action th-actions',targets:0,title:"Actions",width:'60px',render:function(e,t,s,a){var n='';return(n+='<button data-uucss-optimize data-url="'+e+'" data-rule="'+s.rule+'" data-rule_id="'+s.rule_id+'" data-regex="'+s.regex+'"><span class="dashicons dashicons-update"></span></button>')+('<button data-uucss-options data-url="'+e+'" data-rule="'+s.rule+'" data-rule_id="'+s.rule_id+'" data-regex="'+s.regex+'" ><span class="dashicons dashicons-ellipsis"></span></button>')}},{data:"meta",visible:!1,render:function(e,t,s,a){return e&&e.warnings&&0<e.warnings.length?'warning':e.status}}],rowCallback:function(n,i,e,t,l){tippy(C(n).find('button[data-uucss-options]')[0],{allowHTML:!0,trigger:'click',arrow:!0,appendTo:C(n).find('button[data-uucss-options]')[0],interactive:!0,animation:'shift-toward',hideOnClick:!0,theme:'light',content:()=>{var e=C('<div class="uucss-option-list"><ul class="option-list"></ul></div>');return('success'===i.status||'rule-based'===i.status)&&i.meta&&i.meta.stats&&e.find('ul').append('<li data-action_name="test"><a data-action_name="test" href="#">GPSI Status</a></li>'),'queued'!==i.status&&'rule-based'!==i.status&&(e.find('ul').append('<li data-action_name="requeue_url"><a data-action_name="requeue_url" href="#">Requeue</a></li>'),window.uucss)&&"1"===window.uucss.cpcss_enabled&&e.find('ul').append('<li data-action_name="regenerate_cpcss"><a data-action_name="regenerate_cpcss" href="#">Regenerate Critical CSS</a></li>'),"1"===C('#thirtd_part_cache_plugins').val()&&e.find('ul').append('<li data-action_name="purge-url"><a data-action_name="purge-url" href="#">Clear Page Cache</a></li>'),i.rule_id&&e.find('ul').append('<li data-action_name="detach_from_rule"><a data-action_name="detach_from_rule" href="#">Detach from Rule</a></li>'),!i.rule_id&&"1"===window.uucss.rules_enabled&&d&&d.rows().data().length&&e.find('ul').append('<li data-action_name="attach_to_rule"><a data-action_name="attach_to_rule" href="#">Attach Rule</a></li>'),e.find('ul').append('<li data-action_name="remove"><a data-action_name="remove" href="#">Remove</a></li>'),e.wrap('<div></div>').parent().html()},onClickOutside(e,t){e.hide()},onCreate(){tippy(C('.uucss-option-list ul.option-list li[data-action_name="remove"]')[0],{content:'Remove RapidLoad cache files',allowHTML:!0,placement:'left',hideOnClick:!1,animation:null,interactive:!0,delay:0,inlinePositioning:!0,maxWidth:500,appendTo:'parent'}),tippy(C('.uucss-option-list ul.option-list li[data-action_name="test"]')[0],{content:'Test Url',allowHTML:!0,placement:'left',hideOnClick:!1,animation:null,interactive:!0,delay:0,inlinePositioning:!0,maxWidth:500,appendTo:'parent'})},onMount(e){C('.uucss-option-list ul.option-list li a').off().click(function(e){var t=C(this);switch(t.data('action_name')){case'requeue_url':v('current',{url:i.url},null,'url');break;case'regenerate_cpcss':wp.ajax.post('cpcss_purge_url',{url:i.url,nonce:window.uucss.nonce}).then(function(e){C.uucssAlert(e,'success')}).fail(function(e){C.uucssAlert(e,'error')});break;case'attach_to_rule':var a=C('<div class="action-content"><div><select class="rule-items" id="attach-rule-item"></select></div><div><p>Base URL : <a class="base-url" target="_blank" href=""></a></p></div><div class="add-action-wrap"></div></div>');d.rows().data().each(function(e,t){var s=C('<option class="rule-item" data-url="'+e.url+'"  data-id="'+e.id+'">Rule : [ '+e.rule+' ] Pattern : [ '+e.regex+' ]</option>');s.attr('value',e.id),a.find('select.rule-items').append(s)}),a.find('.add-action-wrap').append('<input id="update-attach-rule" type="button" class="button button-primary" value="Attach Rule">'),a.find('#update-attach-rule').data('url',i.url),C.featherlight(a,{variant:'attach-rule-content-model uucss-update-form-fetherlight',afterOpen:function(){C('#attach-rule-item').change(function(){var e=a.find('option[value="'+C(this).val()+'"]').data('url');C('.attach-rule-content-model a.base-url').text(e),C('.attach-rule-content-model a.base-url').attr('href',e)}),C('#attach-rule-item').trigger('change'),C('#update-attach-rule').click(function(){wp.ajax.post('attach_rule',{nonce:window.uucss.nonce,url:i.url,type:'attach',rule_id:C('#attach-rule-item').val()}).then(function(e){C.uucssAlert(e,'success');e=C.featherlight.current();e&&e.close()}).fail(function(e){C.uucssAlert(e,'error')})})}});break;case'detach_from_rule':wp.ajax.post('attach_rule',{url:i.url,type:'detach',nonce:window.uucss.nonce}).then(function(e){C.uucssAlert(e,'success')}).fail(function(e){C.uucssAlert(e,'error')});break;case'remove':w(i.url,!0,n,l,i)
/*wp.ajax.post('rapidload_purge_all',{
                                        job_type : 'url',
                                        url : data.url,
                                        clear : true
                                    }).then(function (i) {

                                    }).done(function(){

                                    });*/;break;case'purge-url':wp.ajax.post('clear_page_cache',{url:i.url,nonce:window.uucss.nonce}).then(function(e){C.uucssAlert(e,'Successfully cleared your page cache')}).fail(function(e){C.uucssAlert(e,'Unknown error occurred when clearing the page cache')});break;case'test':if(t.data('fetching'))return;C.ajax({method:'POST',url:wp.ajax.settings.url+'?action=uucss_test_url',data:{url:i.url,nonce:window.uucss.nonce},beforeSend(){t.data('fetching',!0)},error:function(e,t,s){var a=C('.featherlight.uucss-gpsi-test .featherlight-content'),n=C('<div class="content"></div>');n.append('<div class="header"></div>'),n.append('<div class="devider"></div>'),n.append('<div class="description"></div>'),n.find('.header').append('<h2><span class="js-gpsi-reult dashicons dashicons-warning"></span>Pending</h2>'),n.find('.description').append('<p>Your optimization is yet to be reflected on Google Page Insight, GT Metrix and all other page speed testing tools.</p>'),a.find('.spinner').remove(),a.append(n.wrap('<div></div>').parent().html())},success:function(e){var t,s,a=C('.featherlight.uucss-gpsi-test .featherlight-content'),n=C('<div class="content"></div>');n.append('<div class="header"></div>'),n.append('<div class="devider"></div>'),n.append('<div class="description"></div>'),e.success&&e.data&&(e.data.injected||e.data.success)&&0<e.data.injectedCSS?(n.find('.header').append('<h2><span class="js-gpsi-reult dashicons dashicons-yes-alt"></span>Success</h2>'),n.find('.description').append('<p>Optimization is now reflected in Google Page Speed Insight, GT Metrix and all other page speed testing tools.</p>')):(n.find('.header').append('<h2><span class="js-gpsi-reult dashicons dashicons-warning"></span>Pending</h2>'),n.find('.description').append('<p>Your optimization is yet to be reflected on Google Page Insight, GT Metrix and all other page speed testing tools.</p>')),e.success&&e.data&&e.data.success&&(t=new URL(e.data.url),(s=new URL(e.data.url)).searchParams.append('no_uucss',''),n.find('.description').html('<p>'+n.find('.description').text()+" Compare your page speed scores:</p>"),n.find('.description').append('<p class="test-site-links-heading without-rapidload"><strong>Without RapidLoad</strong></p>'),n.find('.description').append('<ul class="test-site-links test-site-links-without"></ul>'),n.find('.test-site-links-without').append('<li class="test-site-link"><a href="https://gtmetrix.com/?url='+s.toString().replace('no_uucss=','no_uucss')+'" target="_blank">GT Metrix</a></li>'),n.find('.test-site-links-without').append('<li class="test-site-link"><a href="https://developers.google.com/speed/pagespeed/insights/?url='+s.toString().replace('no_uucss=','no_uucss')+'" target="_blank">Google Insights</a></li>'),n.find('.description').append('<p class="test-site-links-heading with-rapidload"><strong>RapidLoad</strong></p>'),n.find('.description').append('<ul class="test-site-links test-site-links-with"></ul>'),n.find('.test-site-links-with').append('<li class="test-site-link"><a href="https://gtmetrix.com/?url='+t.toString()+'" target="_blank">GT Metrix</a></li>'),n.find('.test-site-links-with').append('<li class="test-site-link"><a href="https://developers.google.com/speed/pagespeed/insights/?url='+t.toString()+'" target="_blank">Google Insights</a></li>')),a.find('.spinner').remove(),a.append(n.wrap('<div></div>').parent().html()),e.success&&e.data&&C('.js-gpsi-reult').featherlight('<div><div class="code"><pre><code>'+JSON.stringify(e.data,void 0,2)+'</code></pre></div></div>',{variant:'uucss-gpsi-result-details'})},complete:function(){t.data('fetching',!1)}})}}),C('.uucss-option-list ul.option-list li a[data-action_name="test"]').featherlight('<div class="spinner loading"></div>',{variant:'uucss-gpsi-test'})},placement:'bottom-end'}),tippy(C(n).find('span.job-status.status.waiting')[0],{content:'Waiting to be processed',placement:'top',appendTo:"parent"}),tippy(C(n).find('button[data-uucss-optimize]')[0],{content:'Refresh files Immediately',placement:'top',appendTo:"parent"}),C(n).find('button').data('index',l),C(n).find('button[data-uucss-options]').off('click').click(function(e){e.preventDefault()}),C(n).find('button[data-uucss-optimize]').off('click').click(function(e){e.preventDefault();var e='string'==typeof C(this).data().uucssClear,t=C(this).data('rule'),s=C(this).data('regex'),a=C(this).data('rule_id');w(i.url,e,n,l,i,{rule:t,rule_id:a,regex:s})}),C(n).find('button[data-uucss-optimize]').off('click').click(function(e){e.preventDefault();e='string'==typeof C(this).data().uucssClear;w(i.url,e,n,l,i,{immediate:!0})})}}),r.addClass('loading'),d=d.DataTable({serverSide:!0,processing:!1,language:{processing:'<span class="spinner loading"></span>'},ajax:{beforeSend(){r.hasClass('loading')||r.addClass('loading')},url:wp.ajax.settings.url+'?action=uucss_data',type:'POST',data:function(e){return""!==u&&void 0!==u&&e.columns[0]&&e.columns[0].search&&(e.columns[0].search.value=u),""!==h&&void 0!==h&&e.columns[1]&&e.columns[1].search&&(e.columns[1].search.value=h,e.columns[1].search.regex=_),e.nonce=uucss.nonce,e.type='rule',e},dataSrc:function(e){return r.removeClass('loading'),e.success?e.data:(C.uucssAlert("Failed to fetch optimizations",'error'),[])}},searching:!0,pagingType:"simple",tfoot:!1,lengthChange:!1,bSort:!1,columns:[{data:"status",title:"Status",width:'50px',className:'dt-body-center dt-head-center',render:function(e,t,s,a){var n='status ';return'queued'!==e&&'processing'!==e||(n+='refresh '),'<span class="job-status '+(n+=e+' ')+'">'+e+'</span>'}},{data:"url",title:"Base",className:"url",render(e){return e?'<a href="'+decodeURI(e)+'" target="_blank">'+decodeURI(e)+'</a>':''}},{data:"applied_links",title:"Jobs",width:'25px',className:'dt-body-center dt-head-center applied-links hits-hidden',render:function(e,t,s,a){return'<span class="" '+(s.applied_links===s.applied_successful_links?'style="font-weight:500"':'')+'>'+e+'</span>'}},{data:"applied_successful_links",title:"Hits",width:'25px',visible:!1,className:'dt-body-center dt-head-center hits-count',render:function(e,t,s,a){return'<span class="">'+e+'</span>'}},{data:"regex",title:"pattern",width:'200px',className:'dt-body-center dt-head-center pattern',render:function(e,t,s,a){return'<span class="">'+(e||'')+'</span>'}},{data:"rule",title:"Rule",width:'100px',className:'dt-body-center dt-head-center',render:function(e,t,s,a){return'<span class="">'+(e?e.replace('is_',''):'')+'</span>'}},{data:"url",className:'dt-body-center dt-head-center stats th-reduction',title:"File Size Reduction",width:'145px',render:function(e,t,s,a){return s.meta&&s.meta.stats&&s.meta.stats.reduction&&'success'===s.status?s.meta.stats.reduction+'%':'queued'===s.status||'processing'===s.status||'waiting'===s.status?'<span class="job-file-size">-</span>':'0 KB'},createdCell:function(e,t,s){var a,n,i,l,e=C(e).wrapInner(C('<span></span>')),u=C('<div class="uucss-warnings"></div>'),c=C('<div class="cpcss-status cpcss-status-'+(s.cpcss?s.cpcss.status:'')+'"></div>'),r=(s.meta&&s.meta.stats&&('success'===s.status||'success'===s.rule_status)&&s.cpcss&&'success'===s.cpcss.status&&(c.append('<span class="dashicons dashicons-yes-alt" style="color : #009688; width: 16px; height: 16px"></span>'),c.append('<span style="font-size: 12px; margin-left:2px">Critical css generated ('+s.cpcss.hits+'/'+s.cpcss.attempts+')</span>')),window.uucss&&window.uucss.uucss_enable_debug||(s.meta.warnings=s.meta.warnings.filter(function(e){return!e.message.toString().includes('optimized version for the file missing')}))
/*if(rowData.meta.warnings && rowData.meta.warnings.length){
                            var scrollable = rowData.meta.warnings.length > 2 ? 'scrollable' : '';
                            $warnings_html.append('<h5 class="warnings-title ">Warnings (' + rowData.meta.warnings.length  + ')</h5>');
                            $warnings_html.append('<ul class="warning-list ' + scrollable  + '"></ul>');
                            $.each(rowData.meta.warnings, function(index, value){
                                var $warning_html = $('<li class="warning"></li>')
                                $warning_html.append('<div class="warning-info"></div>');
                                $warning_html.find('.warning-info').append('<p class="warning-header">' +  value.message + '</p>');
                                if(value.file){
                                    $warning_html.find('.warning-info').append('<p class="warning-content"><a href="' + value.file +'" target="_blank">' +  value.file + '</a></p>');
                                }
                                $warnings_html.find('.warning-list').append($warning_html.wrap('<div></div>').parent().html())
                            })
                        }else{
                            
                        }*/,u.removeClass('uucss-warnings'),'');0<s.success_count?r='Hits : '+s.success_count+'/'+s.attempts:s.meta&&s.meta.stats&&s.meta.stats.success_count?r='Hits : '+s.meta.stats.success_count+'/'+s.attempts:0!==Number(s.attempts)&&(r='Attempts : '+s.attempts),i={theme:'light',triggerTarget:e.find('span')[0],content:function(){var e=C("<div class=\"stat-tooltip\">       <div class=\"progress-bar-wrapper\">           <div class=\"progress-bar w-100\">               <span style=\"width:"+(100-s.meta.stats.reduction)+'%">'+(100-s.meta.stats.reduction).toFixed()+"%               </span>           </div>       </div>"+c.wrap('<div class="cpcss-result"></div>').parent().html()+u.wrap('<div></div>').parent().html()+"<div class=\"time\">   <p class=\"val uucss-show-job-details\">Created at "+new Date(1e3*s.time).toLocaleDateString()+' '+new Date(1e3*s.time).toLocaleTimeString()+"   </p>   <p class=\"attempts\">"+r+"   </p></div></div>");return a=tippy(e.find('.progress-bar-wrapper')[0],{content:'Without RapidLoad <span class="perc">'+s.meta.stats.before+'</span>',allowHTML:!0,placement:'bottom-end',trigger:'manual',hideOnClick:!1,animation:null,theme:'tomato',interactive:!0,delay:0,offset:[0,7],inlinePositioning:!0}),n=tippy(e.find('.progress-bar')[0],{content:'RapidLoad <span class="perc"> '+s.meta.stats.after+'</span>',allowHTML:!0,placement:'top-start',trigger:'manual',hideOnClick:!1,animation:null,theme:'ketchup',interactive:!0,delay:0,inlinePositioning:!0}),e[0]},placement:'left',
//trigger: 'click',
interactive:!0,allowHTML:!0,animation:"shift-toward-extreme",appendTo:"parent",onShow:function(){a.show(),n.show()},onShown:function(e){C(e.popper).find('.progress-bar.w-100').removeClass('w-100'),C('.uucss-show-job-details').featherlight('<div><div class="code"><pre><code>'+JSON.stringify(s,void 0,2)+'</code></pre></div></div>',{variant:'uucss-job-details'})},onHide:function(e){a.hide(),n.hide(),C(e.popper).find('.progress-bar').addClass('w-100')}},'failed'===s.status?(e.find('span').append('<span class="dashicons dashicons-info error"></span>'),i.onShow=function(){},i.onHide=function(){},l=s.meta.error.code||500,i.content='<div class="error-tooltip"><h5>Error</h5> <span><strong>CODE :</strong> '+l+'</span> <br><span>'+s.meta.error.message+'</span></div>',
//tippyOptions.triggerTarget = $(td).closest('tr')[0]
tippy(e.find('span')[0],i)):'success'!==s.status||s.meta.warnings&&s.meta.warnings.length?'success'===s.status&&s.meta.warnings.length&&(e.find('span').append('<span class="dashicons dashicons-warning"></span>'),tippy(e.find('span')[0],i)):(l=s.meta&&s.meta.stats&&0<s.meta.stats.success_count||0<Number(s.success_count)?'hits-success':'',e.find('span').append('<span class="dashicons dashicons-yes-alt '+l+'"></span>'),tippy(e.find('span')[0],i))}},{data:"meta",visible:!1,render:function(e,t,s,a){return e&&e.warnings&&0<e.warnings.length?'warning':e.status}},{data:"url",className:'dt-body-right dt-head-right action th-actions',targets:0,title:"Actions",width:'60px',render:function(e,t,s,a){var n='';return(n+='<button data-uucss-optimize data-url="'+e+'" data-rule="'+s.rule+'" data-rule_id="'+s.id+'" data-regex="'+s.regex+'"><span class="dashicons dashicons-update"></span></button>')+('<button data-uucss-options data-url="'+e+'" data-rule="'+s.rule+'" data-regex="'+s.regex+'"><span class="dashicons dashicons-ellipsis"></span></button>')}}],rowCallback:function(l,u,e,t,c){tippy(C(l).find('button[data-uucss-options]')[0],{allowHTML:!0,trigger:'click',arrow:!0,appendTo:C(l).find('button[data-uucss-options]')[0],interactive:!0,animation:'shift-toward',hideOnClick:!0,theme:'light',content:()=>{var e=C('<div class="uucss-option-list"><ul class="option-list"></ul></div>');return e.find('ul').append('<li data-action_name="edit_rule"><a data-action_name="edit_rule" href="#" data-url="'+u.url+'" data-rule="'+u.rule+'" data-regex="'+u.regex+'" data-index="'+c+'">Edit</a></li>'),e.find('ul').append('<li data-action_name="duplicate_rule"><a data-action_name="duplicate_rule" href="#" data-url="'+u.url+'" data-rule="'+u.rule+'" data-regex="'+u.regex+'" data-index="'+c+'">Duplicate</a></li>'),'queued'!==u.status&&(e.find('ul').append('<li data-action_name="requeue_rule"><a data-action_name="requeue_rule" href="#" data-url="'+u.url+'" data-rule="'+u.rule+'" data-regex="'+u.regex+'" data-index="'+c+'">Requeue</a></li>'),window.uucss)&&"1"===window.uucss.cpcss_enabled&&e.find('ul').append('<li data-action_name="regenerate_cpcss"><a data-action_name="regenerate_cpcss" href="#" data-url="'+u.url+'" data-rule="'+u.rule+'" data-regex="'+u.regex+'" data-index="'+c+'">Regenerate Critical CSS</a></li>'),'success'===u.status&&e.find('ul').append('<li data-action_name="test"><a data-action_name="test" href="#" data-url="'+u.url+'" data-rule="'+u.rule+'" data-regex="'+u.regex+'" data-index="'+c+'">GPSI Status</a></li>'),"1"===C('#thirtd_part_cache_plugins').val()&&e.find('ul').append('<li data-action_name="purge-url"><a data-action_name="purge-url" data-rule="'+u.rule+'" data-regex="'+u.regex+'" href="#" data-url="'+u.url+'" data-index="'+c+'">Clear Page Cache</a></li>'),e.find('ul').append('<li data-action_name="remove"><a data-action_name="remove" href="#" data-url="'+u.url+'" data-rule="'+u.rule+'" data-regex="'+u.regex+'" data-index="'+c+'">Remove</a></li>'),e.wrap('<div></div>').parent().html()},onClickOutside(e,t){e.hide()},onCreate(){tippy(C('.uucss-option-list ul.option-list li[data-action_name="remove"]')[0],{content:'Remove RapidLoad cache files',allowHTML:!0,placement:'left',hideOnClick:!1,animation:null,interactive:!0,delay:0,inlinePositioning:!0,maxWidth:500,appendTo:'parent'}),tippy(C('.uucss-option-list ul.option-list li[data-action_name="test"]')[0],{content:'Test Url',allowHTML:!0,placement:'left',hideOnClick:!1,animation:null,interactive:!0,delay:0,inlinePositioning:!0,maxWidth:500,appendTo:'parent'})},onMount(e){C('.uucss-option-list ul.option-list li a').off().click(function(e){var t=C(this),s=t.data('action_name'),a=t.data('rule'),n=t.data('regex'),i=t.data('url');switch(s){case'requeue_rule':v('current',{url:i,rule:a,regex:n},null,'rule');break;case'regenerate_cpcss':wp.ajax.post('cpcss_purge_url',{url:i,nonce:window.uucss.nonce}).then(function(e){C.uucssAlert(e,'success')}).fail(function(e){C.uucssAlert(e,'error')});break;case'duplicate_rule':C.featherlight(C('#add_rule_featherlight_content'),{variant:'add-site-rule-model',afterOpen:function(){this.$content.find('#model-uucss-rules').val(a),this.$content.find('input.rule-base-url').val(i),this.$content.find('input.rule-url-regex').val(n)}});break;case'edit_rule':C.featherlight(C('#add_rule_featherlight_content'),{variant:'add-site-rule-model',afterOpen:function(){this.$content.find('#model-uucss-rules').val(a),this.$content.data('old_rule',a),this.$content.find('input.rule-base-url').val(i),this.$content.data('old_base_url',i),this.$content.find('input.rule-url-regex').val(n),this.$content.data('old_rule_regex',n)}});break;case'remove':w(u.url,!0,l,c,u,{rule:a,regex:n})
/*wp.ajax.post('rapidload_purge_all',{
                                        job_type : 'rule',
                                        rule : rule,
                                        regex : regex,
                                        clear : true
                                    }).then(function (i) {

                                    }).done(function(){

                                    });*/;break;case'purge-url':wp.ajax.post('clear_page_cache',{url:u.url,rule:a,regex:n,nonce:window.uucss.nonce}).then(function(e){C.uucssAlert(e,'Successfully cleared your page cache')}).fail(function(e){C.uucssAlert(e,'Unknown error occurred when clearing the page cache')});break;case'test':if(t.data('fetching'))return;C.ajax({method:'POST',url:wp.ajax.settings.url+'?action=uucss_test_url',data:{url:u.url,type:'rule',rule:a,regex:n,nonce:window.uucss.nonce},beforeSend(){t.data('fetching',!0)},error:function(e,t,s){var a=C('.featherlight.uucss-gpsi-test .featherlight-content'),n=C('<div class="content"></div>');n.append('<div class="header"></div>'),n.append('<div class="devider"></div>'),n.append('<div class="description"></div>'),n.find('.header').append('<h2><span class="js-gpsi-reult dashicons dashicons-warning"></span>Pending</h2>'),n.find('.description').append('<p>Your optimization is yet to be reflected on Google Page Insight, GT Metrix and all other page speed testing tools.</p>'),a.find('.spinner').remove(),a.append(n.wrap('<div></div>').parent().html())},success:function(e){var t,s,a=C('.featherlight.uucss-gpsi-test .featherlight-content'),n=C('<div class="content"></div>');n.append('<div class="header"></div>'),n.append('<div class="devider"></div>'),n.append('<div class="description"></div>'),e.success&&e.data&&(e.data.injected||e.data.success)&&0<e.data.injectedCSS?(n.find('.header').append('<h2><span class="js-gpsi-reult dashicons dashicons-yes-alt"></span>Success</h2>'),n.find('.description').append('<p>Optimization is now reflected in Google Page Speed Insight, GT Metrix and all other page speed testing tools.</p>')):(n.find('.header').append('<h2><span class="js-gpsi-reult dashicons dashicons-warning"></span>Pending</h2>'),n.find('.description').append('<p>Your optimization is yet to be reflected on Google Page Insight, GT Metrix and all other page speed testing tools.</p>')),e.success&&e.data&&e.data.success&&(t=new URL(e.data.url),(s=new URL(e.data.url)).searchParams.append('no_uucss',''),n.find('.description').html('<p>'+n.find('.description').text()+" Compare your page speed scores:</p>"),n.find('.description').append('<p class="test-site-links-heading without-rapidload"><strong>Without RapidLoad</strong></p>'),n.find('.description').append('<ul class="test-site-links test-site-links-without"></ul>'),n.find('.test-site-links-without').append('<li class="test-site-link"><a href="https://gtmetrix.com/?url='+s.toString().replace('no_uucss=','no_uucss')+'" target="_blank">GT Metrix</a></li>'),n.find('.test-site-links-without').append('<li class="test-site-link"><a href="https://developers.google.com/speed/pagespeed/insights/?url='+s.toString().replace('no_uucss=','no_uucss')+'" target="_blank">Google Insights</a></li>'),n.find('.description').append('<p class="test-site-links-heading with-rapidload"><strong>RapidLoad</strong></p>'),n.find('.description').append('<ul class="test-site-links test-site-links-with"></ul>'),n.find('.test-site-links-with').append('<li class="test-site-link"><a href="https://gtmetrix.com/?url='+t.toString()+'" target="_blank">GT Metrix</a></li>'),n.find('.test-site-links-with').append('<li class="test-site-link"><a href="https://developers.google.com/speed/pagespeed/insights/?url='+t.toString()+'" target="_blank">Google Insights</a></li>')),a.find('.spinner').remove(),a.append(n.wrap('<div></div>').parent().html()),e.success&&e.data&&C('.js-gpsi-reult').featherlight('<div><div class="code"><pre><code>'+JSON.stringify(e.data,void 0,2)+'</code></pre></div></div>',{variant:'uucss-gpsi-result-details'})},complete:function(){t.data('fetching',!1)}})}}),C('.uucss-option-list ul.option-list li a[data-action_name="test"]').featherlight('<div class="spinner loading"></div>',{variant:'uucss-gpsi-test'})},placement:'bottom-end'}),tippy(C(l).find('span.job-status.status.waiting')[0],{content:'Waiting to be processed',placement:'top',appendTo:"parent"}),tippy(C(l).find('button[data-uucss-optimize]')[0],{content:'Refresh files Immediately',placement:'top',appendTo:"parent"}),C(l).find('button').data('index',c),C(l).find('button[data-uucss-options]').off('click').click(function(e){e.preventDefault()}),C(l).find('button[data-uucss-optimize]').off('click').click(function(e){e.preventDefault();var e='string'==typeof C(this).data().uucssClear,t=C(this).data('rule'),s=C(this).data('regex'),a=C(this).data('rule_id');w(u.url,e,l,c,u,{rule:t,rule_id:a,regex:s})}),C(l).find('button[data-uucss-optimize]').off('click').click(function(e){e.preventDefault();e='string'==typeof C(this).data().uucssClear;w(u.url,e,l,c,u,{immediate:!0})})}}),C('button.uucss-add-site-urls-submenu').off('click').click(function(e){e.preventDefault()}),C('button.uucss-add-site-rule-submenu').off('click').click(function(e){e.preventDefault()}),tippy(C('button.uucss-add-site-urls-submenu')[0],{allowHTML:!0,trigger:'click',arrow:!0,appendTo:C('button.uucss-add-site-urls-submenu')[0],interactive:!0,animation:'shift-toward',hideOnClick:!0,theme:'light',content:()=>{var e=C('<div class="uucss-submenu-option-list"><ul class="option-list"></ul></div>');return e.find('ul').append('<li class="simple-menu" data-action_name="requeue_all"><a data-action_name="requeue_all" href="#">Requeue All</a></li>'),e.find('ul').append('<li class="multi-select-menu" data-action_name="requeue_selected"><a data-action_name="requeue_selected" href="#">Requeue Selected</a></li>'),e.find('ul').append('<li class="simple-menu" data-action_name="requeue_processing"><a data-action_name="requeue_processing" href="#">Requeue Pending</a></li>'),e.find('ul').append('<li class="simple-menu" data-action_name="requeue_warnings"><a data-action_name="requeue_warnings" href="#">Requeue Warnings</a></li>'),e.find('ul').append('<li class="simple-menu" data-action_name="requeue_failed"><a data-action_name="requeue_failed" href="#">Requeue Failed</a></li>'),e.find('ul').append('<li class="simple-menu" data-action_name="remove_all"><a data-action_name="remove_all" href="#">Remove All</a></li>'),e.find('ul').append('<li class="multi-select-menu" data-action_name="remove_selected"><a data-action_name="remove_selected" href="#">Remove Selected</a></li>'),e.find('ul').append('<li class="select-all" data-action_name="select_all"><a data-action_name="select_all" href="#">Select All</a></li>'),window.uucss&&"1"===window.uucss.dev_mode&&e.find('ul').append('<li data-action_name="run_gpsi_test"><a data-action_name="run_gpsi_test" href="#">Run GPSI Test</a></li>'),"1"===C('#thirtd_part_cache_plugins').val()&&e.find('ul').append('<li data-action_name="clear_warnings_cache"><a data-action_name="clear_warnings_cache" href="#">Clear Page Cache</a></li>'),e.wrap('<div></div>').parent().html()},onClickOutside(e,t){e.hide()},onCreate(){},onMount(e){C('.uucss-submenu-option-list ul.option-list li a').off().click(function(e){var t=C(this).data('action_name');switch(t){case'rule-stats':wp.ajax.post('uucss_rule_stats').then(function(e){var a;e&&(a=C('<div class="rule-stats-cont"><ol class="duplicates"></ol></div>'),e.duplicateFiles&&e.duplicateFiles.length&&C.each(e.duplicateFiles,function(e,t){var s=C('<li class="duplicate-file-item"></li>');s.data('otherURLs',t.otherUrls),s.append('<p>Count : '+t.count+' Link : <a class="duplicate-file-item-base" target="_blank" href="'+t.url+'">'+t.url+'</a></p>'),a.find('ol.duplicates').append(s)}),C.featherlight(a,{variant:'uucss-rule-stats',afterOpen:function(){C.each(C('a.duplicate-file-item-base'),function(e,t){var s=C('<div><ol class="duplicate-other-urls"></ol></div>'),a=C(t).parent().parent().data('otherURLs');a&&a.length&&C.each(a,function(e,t){s.find('ol').append('<li><a target="_blank" href="'+t+'">'+t+'</a>')}),tippy(C(t)[0],{content:s.html(),theme:'light',allowHTML:!0,interactive:!0,hideOnClick:!0,placement:'right'})})}}))});break;case'requeue_selected':case'requeue_all':var s=[];o.rows('.selected').data().length&&C.each(o.rows('.selected').data(),function(e,t){s.push(t.id)}),v('current',{},s,'requeue_all_url'),C.uucssAlert('Successfully added links added to the queue');break;case'requeue_warnings':v('warnings',{},s,'requeue_all_url_warnings'),C.uucssAlert('Successfully added links added to the queue');break;case'requeue_failed':v('failed',{},s,'requeue_all_url_failed'),C.uucssAlert('Successfully added links added to the queue');break;case'requeue_processing':v('processing',{},s,'requeue_all_url_processing'),C.uucssAlert('Successfully added links added to the queue');break;case'remove_selected':case'remove_all':var a,n={url:'',clear:!0,job_type:'url',nonce:window.uucss.nonce};'remove_selected'===t&&(a=[],o.rows('.selected').data().length&&C.each(o.rows('.selected').data(),function(e,t){a.push(t.id)}),a.length
/*wp.ajax.post('uucss_purge_url',data).then(function (i) {
                                if(table){
                                    table.ajax.reload(null, false);
                                    $.uucssAlert('Successfully removed links from the table', 'info');
                                }
                            }).done(function(){
                                $('#uucss-wrapper li.uucss-history').hasClass('multi-select') && $('#uucss-wrapper li.uucss-history').removeClass('multi-select')
                            });
                            wp.ajax.post('cpcss_purge_url',data).then(function (i) {

                            }).done(function(){

                            });*/)&&(n.url_list=a),wp.ajax.post('rapidload_purge_all',n).then(function(e){}).done(function(){C('#uucss-wrapper li.uucss-history').hasClass('multi-select')&&C('#uucss-wrapper li.uucss-history').removeClass('multi-select')});break;case'clear_warnings_cache':wp.ajax.post('clear_page_cache',{status:'warnings',nonce:window.uucss.nonce}).then(function(e){C.uucssAlert(e,'Successfully cleared your page cache')}).fail(function(e){C.uucssAlert(e,'Unknown error occurred when clearing the page cache')});break;case'run_gpsi_test':wp.ajax.post('uucss_run_gpsi_status_check_for_all',{nonce:window.uucss.nonce}).then(function(e){C.uucssAlert('GPSI test run started')}).fail(function(e){});break;case'select_all':n=C('#uucss-wrapper li.uucss-job-history');n.hasClass('multi-select')&&n.removeClass('multi-select'),n.find('table tbody tr').hasClass('selected')&&n.find('table tbody tr').removeClass('selected'),n.find('table tbody tr').addClass('selected'),n.addClass('multi-select'),n.find('.multiple-selected-text .multiple-selected-value').text('('+n.find('table tbody tr.selected').length+') URLs')}})},placement:'bottom-end'}),tippy(C('button.uucss-add-site-rule-submenu')[0],{allowHTML:!0,trigger:'click',arrow:!0,appendTo:C('button.uucss-add-site-rule-submenu')[0],interactive:!0,animation:'shift-toward',hideOnClick:!0,theme:'light',content:()=>{var e=C('<div class="uucss-submenu-option-list"><ul class="option-list"></ul></div>');return e.find('ul').append('<li class="simple-menu" data-action_name="requeue_all"><a data-action_name="requeue_all" href="#">Requeue All</a></li>'),e.find('ul').append('<li class="multi-select-menu" data-action_name="requeue_selected"><a data-action_name="requeue_selected" href="#">Requeue Selected</a></li>'),e.find('ul').append('<li class="simple-menu" data-action_name="requeue_processing"><a data-action_name="requeue_processing" href="#">Requeue Pending</a></li>'),e.find('ul').append('<li class="simple-menu" data-action_name="requeue_warnings"><a data-action_name="requeue_warnings" href="#">Requeue Warnings</a></li>'),e.find('ul').append('<li class="simple-menu" data-action_name="requeue_failed"><a data-action_name="requeue_failed" href="#">Requeue Failed</a></li>'),e.find('ul').append('<li class="simple-menu" data-action_name="remove_all"><a data-action_name="remove_all" href="#">Remove All</a></li>'),e.find('ul').append('<li class="multi-select-menu" data-action_name="remove_selected"><a data-action_name="remove_selected" href="#">Remove Selected</a></li>'),e.find('ul').append('<li class="select-all" data-action_name="select_all"><a data-action_name="select_all" href="#">Select All</a></li>'),e.find('ul').append('<li class="export-all" data-action_name="export_all"><a data-action_name="export_all" href="#">Export</a></li>'),e.find('ul').append('<li class="import-all" data-action_name="import_all"><a data-action_name="import_all" href="#">Import</a></li>'),e.wrap('<div></div>').parent().html()},onClickOutside(e,t){e.hide()},onCreate(){},onMount(e){C('.uucss-submenu-option-list ul.option-list li a').off().click(function(e){var t=C(this).data('action_name');switch(t){case'requeue_selected':case'requeue_all':var s=[];d.rows('.selected').data().length&&C.each(o.rows('.selected').data(),function(e,t){s.push(t.id)}),v('current',{},s,'requeue_all_rule'),C.uucssAlert('Successfully added links added to the queue');break;case'requeue_warnings':v('warnings',{},null,'requeue_all_rule_warnings'),C.uucssAlert('Successfully added links added to the queue');break;case'requeue_failed':v('failed',{},null,'requeue_all_rule_failed'),C.uucssAlert('Successfully added links added to the queue');break;case'requeue_processing':v('processing',{},null,'requeue_all_rule_processing'),C.uucssAlert('Successfully added links added to the queue');break;case'remove_selected':case'remove_all':var a,n={url:'',clear:!0,nonce:window.uucss.nonce,job_type:'rule',args:{type:'rule'}};'remove_selected'===t&&(a=[],d.rows('.selected').data().length&&C.each(d.rows('.selected').data(),function(e,t){a.push({url:t.url,rule:t.rule,regex:t.regex})}),a.length
/*wp.ajax.post('uucss_purge_url',data).then(function (i) {
                                if(rule_table){
                                    rule_table.ajax.reload(null, false);
                                    $.uucssAlert('Successfully removed links from the table', 'info');
                                }
                            }).done(function(){
                                $('#uucss-wrapper li.uucss-history').hasClass('multi-select') && $('#uucss-wrapper li.uucss-history').removeClass('multi-select')
                            });*/)&&(n.url_list=a),wp.ajax.post('rapidload_purge_all',n).then(function(e){}).done(function(){C('#uucss-wrapper li.uucss-history').hasClass('multi-select')&&C('#uucss-wrapper li.uucss-history').removeClass('multi-select')});break;case'clear_warnings_cache':wp.ajax.post('clear_page_cache',{status:'warnings',type:'rule',nonce:window.uucss.nonce}).then(function(e){C.uucssAlert(e,'Successfully cleared your page cache')}).fail(function(e){C.uucssAlert(e,'Unknown error occurred when clearing the page cache')});break;case'run_gpsi_test':wp.ajax.post('uucss_run_gpsi_status_check_for_all',{nonce:window.uucss.nonce}).then(function(e){C.uucssAlert('GPSI test run started')}).fail(function(e){});break;case'select_all':n=C('#uucss-wrapper li.uucss-rule-history');n.hasClass('multi-select')&&n.removeClass('multi-select'),n.find('table tbody tr').hasClass('selected')&&n.find('table tbody tr').removeClass('selected'),n.find('table tbody tr').addClass('selected'),n.addClass('multi-select'),n.find('.multiple-selected-text .multiple-selected-value').text('('+n.find('table tbody tr.selected').length+') URLs');break;case'export_all':wp.ajax.post('get_all_rules',{nonce:window.uucss.nonce}).then(function(e){var t;e&&((t=document.createElement('a')).download='rapidload-rules-'+Date.now(),t.href='data:text/plain;charset=utf-8,'+JSON.stringify(e),t.style.display="none",t.click())}).fail(function(e){});break;case'import_all':n=document.createElement('input');n.type='file',n.addEventListener('change',function(e){var t=new FileReader;t.onload=function(){wp.ajax.post('upload_rules',{nonce:window.uucss.nonce,rules:t.result}).then(function(e){C.uucssAlert(e)}).fail(function(e){C.uucssAlert(e,'Error')})},t.readAsText(this.files[0])}),n.click()}})},placement:'bottom-end'}),C('#uucss_queue_interval').change(function(){y(C(this).val(),!0)}),y(C('#uucss_queue_interval').val(),!1),C('#uucss-deactivate').click(function(e){e.preventDefault();let t=C(this);t.text('deactivating...'),wp.ajax.post('uucss_deactivate',{nonce:window.uucss.nonce}).done(function(e){t.text('deactivated'),window.location.reload()})}),C('a.connect-with-license').click(function(e){e.preventDefault()}),tippy('a.connect-with-license',{allowHTML:!0,arrow:!1,appendTo:C('a.connect-with-license')[0],interactive:!0,animation:'shift-toward',placement:'top-start',trigger:'click',hideOnClick:!1,theme:'light',maxWidth:500,onClickOutside(e,t){e.hide()},content:function(){return"<div class=\"tippy-connect-with-license\">               <div class=\"tippy-connect-with-license-content\">                   <div class=\"header-text\">                       <p>Enter your License Key below</p>                   </div>                   <div class=\"input-wrap\">                       <input type=\"text\"  placeholder=\"License Key\" class=\"uucss-key\">                       <a href=\"#\" class=\"connect\">Connect</a>                   </div>                   <div><p class=\"uucss-key-error\"></p></div>               </div>          </div>"},onMount(e){C('a.connect-with-license .tippy-connect-with-license-content input.uucss-key').focus(),C('a.connect-with-license .tippy-connect-with-license-content .input-wrap .connect').click(function(e){e.preventDefault();var t,s=C('a.connect-with-license .tippy-connect-with-license-content .input-wrap input').val();''===s?C.uucssAlert('Please enter a license key','error'):((t=C(this)).text('Connecting...'),t.removeAttr('href'),wp.ajax.post('uucss_connect',{license_key:s,nonce:window.uucss.nonce}).then(function(e){e.success&&(window.location.href=window.location.href+'&token='+s+'&nonce='+e.activation_nonce)}).fail(function(e){t.text('Connect'),t.attr('href','#'),C('a.connect-with-license p.uucss-key-error').text(e)}))})}}),C('#model-requeue-post-type').change(function(){$model_content=C('.featherlight.add-site-url-model'),'site_map'===C(this).val()||'url'===C(this).val()?('site_map'===C(this).val()?($model_content.find('input.site-map-url').attr('placeholder',$model_content.find('input.site-map-url').data('sitemap_url')),$model_content.find('input.site-map-url').val($model_content.find('input.site-map-url').data('sitemap_url'))):'url'===C(this).val()&&$model_content.find('input.site-map-url').attr('placeholder',$model_content.find('input.site-map-url').data('site_url')),$model_content.find('input.site-map-url').hasClass('show')||$model_content.find('input.site-map-url').addClass('show'),$model_content.hasClass('show-url')||$model_content.addClass('show-url')):($model_content.find('input.site-map-url').hasClass('show')&&$model_content.find('input.site-map-url').removeClass('show'),$model_content.hasClass('show-url')&&$model_content.removeClass('show-url'))}),C('#model-update-rule').click(function(){var t,e=($model_content=C('.featherlight #add_rule_featherlight_content')).find('#model-uucss-rules'),s=$model_content.find('.rule-base-url'),a=$model_content.find('.rule-url-regex'),n=$model_content.find('#force-requeue-rule');""===e.val()||""===s.val()||""===a.val()?C.uucssAlert('Required fields missing','error'):x(s.val())?((t=C(this)).attr('disabled',!0),t.val('Please wait....'),wp.ajax.post('uucss_update_rule',{rule:e.val(),url:s.val(),regex:a.val(),old_rule:$model_content.data('old_rule'),old_url:$model_content.data('old_base_url'),old_regex:$model_content.data('old_rule_regex'),requeue:n.is(':checked')?"1":"0",nonce:window.uucss.nonce}).then(function(e){C.uucssAlert(e);e=C.featherlight.current();e&&e.close(),t.attr('disabled',!1),t.val('Update Rule')}).fail(function(e){C.uucssAlert(e,'error'),t.attr('disabled',!1),t.val('Update Rule')}).done(function(){d.ajax.reload(null,!1)})):C.uucssAlert('Invalid Url','error')}),C('#model-queue-posts-type').click(function(){var s,e;('site_map'!==($model_content=C('.featherlight #add_url_featherlight_content')).find('#model-requeue-post-type').val()&&'url'!==$model_content.find('#model-requeue-post-type').val()||""!==$model_content.find('input.site-map-url').val()&&void 0!==$model_content.find('input.site-map-url').val())&&('site_map'!==$model_content.find('#model-requeue-post-type').val()&&'url'!==$model_content.find('#model-requeue-post-type').val()||x($model_content.find('input.site-map-url').val()))?((s=C(this)).attr('disabled',!0),s.val('Please wait....'),e={post_type:$model_content.find('#model-requeue-post-type').val(),job_type:$model_content.find('#model-requeue-post-type').val(),url:$model_content.find('input.site-map-url').val(),nonce:window.uucss.nonce},wp.ajax.post('rapidload_purge_all',e).then(function(e){C.uucssAlert('Sitemap links scheduled to be added to the queue.');var t=C.featherlight.current();t&&t.close(),s.attr('disabled',!1),s.val('Add')}).fail(function(e){C.uucssAlert(e,'error'),s.attr('disabled',!1),s.val('Add')}).done(function(){o.ajax.reload(null,!1)})):C.uucssAlert('Add a valid URL','error')}),C('p.more-info-uucss-status').click(function(e){e.preventDefault();e=C('.rapidload-status .uucss-status-more-info');"block"===e.css('display')?e.slideUp():e.slideDown()}),C('#js-uucss-clear-selection').click(function(e){e.preventDefault(),C('#uucss-history tbody tr').removeClass('selected'),C('#uucss-wrapper li.uucss-history.uucss-job-history').removeClass('multi-select')}),C('#js-uucss-clear-selection-rule').click(function(e){e.preventDefault(),C('#uucss-rule-history tbody tr').removeClass('selected'),C('#uucss-wrapper li.uucss-history.uucss-rule-history').removeClass('multi-select')}),wp.ajax.post('rapidload_notifications',{nonce:window.uucss.nonce}).then(function(e){var t;e&&(window.uucss.faqs=e.faqs,window.uucss.public_notices=e.notifications),window.uucss&&window.uucss.faqs.length&&(t=C('#uucss-wrapper'),(e=C(C('.uucss-info-wrapper.safelist-settings')[0]).clone().css('max-width','100%')).length)&&(e.prepend('<h3>Frequently Asked Questions<a id="uucss-faq-read" href="#">close</a></h3>'),e.find('h4').text(window.uucss.faqs[0].title),e.find('h4').attr('data-index',0),e.find('.info-icon').remove(),e.find('p').remove(),e.find('.info-details').append('<p class="divider"></p>').append('<p class="answer">'+window.uucss.faqs[0].message+'</p>'),t.prepend('<li class="uucss-notification uucss-notification-faq uucss-info-wrapper"><span class="dashicons dashicons-arrow-left-alt2 prev-faq nav-faq"></span><span class="dashicons dashicons-arrow-right-alt2 next-faq nav-faq"></span><div class="content">'+e.html()+'</div></li>').parent().show(),t.find('.uucss-notification-faq .dashicons.nav-faq').click(function(){var e=C(this),t=e.parent().find('h4'),s=e.parent().find('p.answer'),a=t.data('index');e.hasClass('prev-faq')?(0===a&&(a=window.uucss.faqs.length),t.text(window.uucss.faqs[a-1].title),s.html(window.uucss.faqs[a-1].message),t.data('index',a-1)):(a===window.uucss.faqs.length-1&&(a=-1),t.text(window.uucss.faqs[a+1].title),s.html(window.uucss.faqs[a+1].message),t.data('index',a+1))}),t.find('#uucss-faq-read').click(function(e){e.preventDefault(),wp.ajax.post('mark_faqs_read',{nonce:window.uucss.nonce}).then(function(e){t.find('.uucss-notification.uucss-notification-faq').remove()}).fail(function(e){})})),window.uucss&&window.uucss.public_notices.length&&window.uucss.public_notices.forEach(function(e){window.uucss&&"1"==window.uucss.cpcss_enabled&&3===e.id||q(e.title,e.message,e.type+' public-notice public-notice-'+e.id,!0,e.id)}),C('#uucss-wrapper').find('span.public-notice').click(function(e){e.preventDefault();var t=C(this);wp.ajax.post('mark_notice_read',{notice_id:t.data('notice_id'),nonce:window.uucss.nonce}).then(function(e){t.parents('li:first').remove()}).fail(function(e){})})});var k;
/*$updateRuleForm.find('select').change(function(){
            var permalink = $updateRuleForm.find('option[data-type="'+ $(this).val() + '"]').data('permalink')
            if(permalink){
                $('#add_rule_featherlight_content input.rule-base-url').focus().val('').val(permalink);
            }
        })

        $updateRuleForm.find('input.rule-base-url').val($updateRuleForm.find('option[data-type="'+ $updateRuleForm.find('select').val() + '"]').data('permalink'));
*/C('#add_rule_featherlight_content');
//setInterval(updateRapidLoadStatus, 60000);
k=C('input.site-map-url'),wp.ajax.post('get_robots_text',{nonce:window.uucss.nonce}).done(function(e){e&&e.sitemap&&k.data('sitemap_url',e.sitemap)})})}(jQuery);